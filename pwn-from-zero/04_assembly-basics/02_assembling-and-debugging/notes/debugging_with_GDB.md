# GDB를 이용한 디버깅 요약 정리

## GDB 디버깅 기본 개념

- 디버깅은 **코드의 문제를 찾아내고 수정**하는 과정
- 주로 다음 4단계로 구성됨:
  1. **Break**: 멈추고 싶은 위치에 브레이크포인트 설정
  2. **Examine**: 레지스터나 메모리 상태 확인
  3. **Step**: 한 줄씩 코드 실행해 흐름 관찰
  4. **Modify**: 레지스터나 메모리 값을 수정해 실험

---

## 1. Break (브레이크포인트 설정)

```bash
gef➤ b _start
gef➤ r
```

- `b _start` → `_start` 함수 진입 지점에 브레이크포인트 걸기
- `r` → 프로그램 실행
- 이후 특정 주소에 브레이크포인트 걸고 싶으면:

```bash
gef➤ b *0x40100a
Breakpoint 1 at 0x40100a
```

> ✨ \*를 붙이면 특정 메모리 주소에 직접 브레이크 설정

## 2. Examine (상태 조사)

- 레지스터/메모리 값을 수동으로 조사할 때 `x` 명령어 사용

### 주요 사용법

```bash
gef➤ x/FMT ADDRESS
```

| FMT 구성 요소 | 설명                                 |
| --------- | ---------------------------------- |
| Count     | 몇 개를 볼지 (예: 4)                     |
| Format    | x(hex), s(string), i(instruction)  |
| Size      | b(1바이트), h(2바이트), w(4바이트), g(8바이트) |

### 예시

- 다음 4개의 명령어를 보기:

```bash
gef➤ x/4ig $rip
=> 0x401000 <_start>:	mov    eax,0x1
   0x401005 <_start+5>:	mov    edi,0x1
   0x40100a <_start+10>:	movabs rsi,0x402000
   0x401014 <_start+20>:	mov    edx,0x12
```

- 문자열 보기:

```bash
gef➤ x/s 0x402000
0x402000:	"Hello HTB Academy!"
```

- 메모리를 헥사 값으로 보기:

```bash
gef➤ x/wx 0x401000
0x401000 <_start>:	0x000001b8

```

## 3. Step (한 줄씩 코드 실행)

### 주요 명령어

| 명령어        | 설명                     |
| ---------- | ---------------------- |
| si (stepi) | 어셈블리 명령어 1줄씩 실행        |
| ni (nexti) | 함수 호출은 무시하고 다음 명령어로 이동 |
| s (step)   | 함수 호출 안으로 들어감          |
| n (next)   | 함수 호출을 스킵하고 다음 줄로 이동   |

### 예시

- 한 줄 이동:

```bash
gef➤ si
```

- 3줄 이동:

```bash
gef➤ si 3
```

- 함수까지 진행:

```bash
gef➤ s
```

> ✨ 엔터키만 눌러도 직전 명령 반복 가능

## 4. Modify (값 수정)

- 특정 시점에 메모리나 레지스터 값을 수정해서 실험할 수 있음

### 메모리 문자열 패치

```bash
gef➤ patch string 0x402000 "Patched!\\x0a"
gef➤ c
```

- `.data` 영역 문자열을 `Patched!\n`로 변경

### 레지스터 수정

```bash
gef➤ set $rdx=0x9
gef➤ c
```

- \$rdx 값을 9로 변경 (출력 문자열 길이 조정)

## 요약

- GDB를 이용해:
  - 프로그램 흐름을 멈추고
  - 레지스터/메모리 상태를 분석하며
  - 한 줄씩 흐름을 따라가고
  - 값도 자유롭게 수정하면서 **디버깅과 리버스 엔지니어링을 할 수 있다.**


